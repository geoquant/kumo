# Progress Log
PRD: agents-md-compliance
Started: 2026-02-21
Branch: geoquant/kumo-regression-prevention (DO NOT switch)

## Codebase Patterns
<!-- Consolidate reusable patterns here -->
- AGENTS.md locations: root, packages/kumo, packages/kumo-docs-astro, packages/kumo-figma, ci/
- All 5 files present as of task start
- Accurate counts: 38 components, 38 primitives, 44 demos + 2 non-demo, 3 blocks, 6 workflows, 6 lint rules
- Docs: 37 component pages, 3 block pages
- CLI commands: ls, doc, add, blocks, init, migrate, ai (7 total)
- Scoring candidates evaluated: lint/ (6 files, skip), .github/ (7 files, skip), kumo/scripts/ (20 files, child of existing), _examples/ (3 example projects, skip)
- VR (visual regression): in preview.yml + preview-deploy.yml, NOT pullrequest.yml. Informational only — never blocks merge.

---
<!-- Task logs below - APPEND ONLY -->

## Task - docs-1
- Created .bak snapshots of all 5 AGENTS.md files before regeneration
- Files: AGENTS.md.bak, packages/kumo/AGENTS.md.bak, packages/kumo-docs-astro/AGENTS.md.bak, packages/kumo-figma/AGENTS.md.bak, ci/AGENTS.md.bak
- Verified: md5 checksums match originals, line counts confirmed (131, 129, 95, 105, 90)
- **Learnings:** All AGENTS.md files are in expected locations per root AGENTS.md STRUCTURE section

## Task - docs-2
- Regenerated all 5 AGENTS.md files with corrected counts and current date/commit
- Key fixes: 35→38 components, 37→38 primitives, added 6 workflows section, added `ai` CLI command, 5→6 lint rules, added demo/block/page counts
- Root: 144 lines. Subdirs: 80, 69, 69, 70 lines (all within limits)
- Scoring: evaluated lint/, .github/, kumo/scripts/, _examples/ — none met threshold for new AGENTS.md
- Files changed: AGENTS.md, packages/kumo/AGENTS.md, packages/kumo-docs-astro/AGENTS.md, packages/kumo-figma/AGENTS.md, ci/AGENTS.md
- **Learnings:** Previous root AGENTS.md incorrectly stated "No GitHub Actions workflows checked into repo" — 6 exist at .github/workflows/. ci/AGENTS.md also incorrectly said "No workflow YAML checked in". Both stale claims fixed.

## Task - docs-3
- Verification-only task — no file changes needed
- Confirmed: root AGENTS.md lines 38-47 document all 6 workflows (reviewer, bonk, pullrequest, preview, preview-deploy, release)
- Confirmed: correct counts — 38 components (line 29), 38 primitives (line 139), 44+ demos (line 33), 3 blocks (line 30)
- Confirmed: no content duplication — root delegates detail to child files, child files cross-reference root
- **Learnings:** Duplication check pattern: root should summarize + delegate via "See child AGENTS.md"; child should have "Parent: See root AGENTS.md". Counts in both are OK if contextual (root in WHERE TO LOOK, child in STRUCTURE).

## Task - docs-4
- Verification-only task — no file changes needed
- Confirmed: packages/kumo/AGENTS.md line 16 lists `ai` in CLI commands, line 40 in WHERE TO LOOK table
- Confirmed: packages/kumo/AGENTS.md line 12 shows correct "38 UI components"
- Cross-verified: `ai.ts` exists in `src/command-line/commands/`, 38 component dirs exist
- **Learnings:** kumo/lint/ has 5 rule files (not 6) — `kumo-plugin.js` is the plugin entry, not a rule. Root AGENTS.md "6 custom JS rules" counts all files including plugin; kumo AGENTS.md "5 custom oxlint rules" counts only rules. Both accurate in their context.

## Task - docs-5
- Fixed ci/AGENTS.md VR gate reference: was `pullrequest.yml` with `skip-vr` bypass, actually `preview.yml` (informational, never blocks merge)
- Verified kumo-docs-astro/AGENTS.md counts all correct: 37 component pages, 3 block pages, 44 demos + 2 non-demo
- Files changed: ci/AGENTS.md
- **Learnings:** VR is in preview.yml (same-repo) and preview-deploy.yml (fork), NOT pullrequest.yml. It's a detection tool — posts before/after screenshots to PR comment — never a merge gate. No `skip-vr` label exists.
