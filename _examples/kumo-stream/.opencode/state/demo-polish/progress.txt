# Progress Log
PRD: demo-polish
Started: 2026-02-19

## Codebase Patterns
- App shell: `src/app/App.tsx` wraps `<ChatDemo />` inside `kumo-root` div with `data-mode`
- Dark mode: `data-mode="light"|"dark"` on root wrapper; Kumo tokens auto-adapt via `light-dark()`
- Kumo `Button` with `variant="outline" size="sm"` for chrome controls (dark mode toggle)
- Plain HTML (`h1`, `p`) for non-interactive text; Kumo `Text` only in component rendering
- ChatDemo controls: `flex gap-2` form, Input `flex-1`, action buttons inline
- Pre-existing lint false positives: `UITreeRenderer.tsx` lines 65/162 (semantic tokens misdetected as raw colors)
- UITree is plain data (`{ root: string, elements: Record<string, UIElement> }`), safe to `structuredClone` for snapshots
- `AssistantSnapshot` renders read-only past turns by omitting `onAction` from `UITreeRenderer`
- `ChatHistoryEntry` discriminated union: `role: "user"` has `content`, `role: "assistant"` has `tree`

---

## Task - ui-1
- Restyled App.tsx to match cross-boundary.html layout
- Container: `max-w-[960px] p-8 px-6` (was `max-w-4xl p-8`)
- Header: flex row with h1 (text-xl font-semibold) + dark mode toggle (Kumo Button outline/sm)
- Subtitle: plain `<p>` with `text-[13px] opacity-60` (was Kumo `Text variant="secondary"`)
- Dark mode: `useState` toggle, sets `data-mode` on root wrapper
- Removed Kumo `Text` import from App.tsx (no longer needed)
- Files changed: `src/app/App.tsx`
- **Learnings:** ChatDemo controls already matched target layout (flex gap-2, Input flex-1). Only App.tsx shell needed restyling.

## Task - ui-2
- Added scrollable conversation history to React SPA
- `ChatHistoryEntry` discriminated union type for user/assistant turns
- `handleSubmit` snapshots current tree (if renderable) + user prompt into `chatHistory` before resetting
- `ChatHistoryView` renders history: `UserBubble` (right-aligned, `bg-kumo-brand-subtle`) and `AssistantSnapshot` (rendered UITree, no `onAction`)
- Scrollable container: `max-h-[70vh] overflow-y-auto` with `useEffect` auto-scroll on `[chatHistory, tree]`
- `handleReset` clears `chatHistory` alongside messages/tree
- Separator `<hr>` between history and current turn when both exist
- Files changed: `src/app/ChatDemo.tsx`
- **Learnings:** `structuredClone(tree)` works perfectly for UITree snapshots since it's plain data. Omitting `onAction` from `UITreeRenderer` is sufficient to make past turns non-interactive â€” no special prop needed.
